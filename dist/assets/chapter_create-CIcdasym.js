import{y as D,z as E,r as i,g as I,j as v,c as d,k as p,u as b,a as e,t as u,w as f,v as x,l as g,b as S,d as V,f as k,q as y,o as h,S as z,n as M,H as N,e as A}from"./index-UL2W14HF.js";import"./trix-C3MFUsML.js";import{c as H}from"./checkAuth-C1L3xOAG.js";const q={class:"p-6 max-w-3xl mx-auto bg-slate-900/50 backdrop-blur-sm"},R=e("a",{class:"px-4 py-1 bg-zinc-100 text-sm text-zinc-800 font-semibold rounded hover:text-black hover:bg-zinc-300 hover:border-transparent focus:outline-none focus:ring-2 focus:ring-purple-600 focus:ring-offset-2",href:"/books"},"Back",-1),U={key:0},j={class:"text-2xl font-bold text-slate-100 mb-6"},L={class:"form-group"},Y=e("label",{for:"chapter-title",class:"block text-xl font-medium text-gray-100"},"Chapter Title",-1),F={class:"form-group"},G=e("label",{for:"chapter-content",class:"block text-xl font-medium text-gray-100"},"Chapter Content",-1),J={class:"mt-1 p-1 bg-slate-50 text-slate-950"},K={key:0,class:"mt-4 text-sm text-green-600"},O={key:1},P=e("p",{class:"text-center text-red-600"},"You must be logged in to create a chapter.",-1),Q=[P],te={__name:"chapter_create",setup(W){const C=D(),$=E(),c=i(""),r=i(""),n=i(""),m=C.params.bookId,_=i({}),w=o=>{r.value=o.target.innerHTML},B=async()=>{var o,a;try{const t=await k.get(`https://api-db-dbxo.onrender.com/api/book/${m}`);_.value=t.data}catch(t){console.error(t),n.value=`Error: ${((a=(o=t.response)==null?void 0:o.data)==null?void 0:a.error)||t.message}`}},T=async o=>{var t,l;o.preventDefault();const a=A.get("accessToken");try{const s=await k.post("https://api-db-dbxo.onrender.com/api/chapter/create",{book_id:m,title:c.value,body:r.value},{headers:{Authorization:`Bearer ${a}`}});n.value=`Chapter created successfully with ID: ${s.data.id}`,$.push(`/book/${m}/chapter/${s.data.id}`),c.value="",r.value=""}catch(s){n.value=`Error: ${((l=(t=s.response)==null?void 0:t.data)==null?void 0:l.error)||s.message}`}};return I(()=>{H(y),B()}),(o,a)=>{const t=v("trix-editor"),l=v("Btn");return h(),d("div",q,[R,p(z),b(y)?(h(),d("div",U,[e("h1",j,"Create Chapter for "+u(_.value.title),1),e("form",{onSubmit:S(T,["prevent"]),class:"space-y-6"},[e("div",L,[Y,f(e("input",{type:"text",id:"chapter-title","onUpdate:modelValue":a[0]||(a[0]=s=>c.value=s),required:"",class:"input",placeholder:"Enter the chapter title"},null,512),[[x,c.value]])]),e("div",F,[G,e("div",J,[p(t,{id:"chapter-content",onTrixChange:w,input:"chapterContentInput"}),f(e("input",{id:"chapterContentInput",type:"hidden","onUpdate:modelValue":a[1]||(a[1]=s=>r.value=s)},null,512),[[x,r.value]])])]),e("div",null,[p(l,{variant:"primary"},{default:g(()=>[M("Submit")]),_:1})])],32),n.value?(h(),d("p",K,u(n.value),1)):V("",!0)])):(h(),d("div",O,Q)),p(b(N),null,{default:g(()=>[e("title",null,`\r
                Create chapter for `+u(o.title)+" | "+u(o.SITE_NAME)+`\r
            `,1)]),_:1})])}}};export{te as default};
