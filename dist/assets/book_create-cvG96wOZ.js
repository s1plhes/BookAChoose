import{_ as F,z as I,r as u,q as k,g as A,j as x,c as T,k as i,l as g,u as w,a as e,w as _,v,B as V,C as $,F as z,e as N,f as U,o as R,t as j,H as q,S as y,n as M,p as P,i as H}from"./index-UL2W14HF.js";import{c as L}from"./checkAuth-C1L3xOAG.js";const c=d=>(P("data-v-7cfb95d6"),d=d(),H(),d),O={class:"px-6 max-w-6xl w-full mx-auto h-full min-h-screen"},W=c(()=>e("h1",{class:"text-xl font-bold text-slate-100 mb-6"},"Create a New Book",-1)),G=c(()=>e("h2",{class:"text-slate-200"},"Welcome to the Book creation wizard",-1)),J={class:"grid grid-cols-2 space-x-12"},K={class:"mb-4"},Q=c(()=>e("label",{for:"title",class:"block text-sm font-medium text-white"},"Title",-1)),X={class:"mb-4"},Y=c(()=>e("label",{for:"author",class:"block text-sm font-medium text-white"},"Author",-1)),Z={class:"mb-4"},ee=c(()=>e("label",{for:"description",class:"block text-sm font-medium text-white"},"Description",-1)),te={class:"mb-4"},oe=c(()=>e("label",{for:"image",class:"block text-sm font-medium text-white"},"Image URL",-1)),ae={__name:"book_create",setup(d){const B=I(),p=u(""),m=u(""),b=u(""),n=u(""),h=k.value.name,f=u(null),C=async o=>{var a,s;o.preventDefault();const t=N.get("accessToken");if(!t){n.value="Authorization token is missing. Please log in again.";return}let r=b.value;if(f.value){const l=await S(f.value);if(l)r=l;else throw new Error("Book upload failed")}try{const{data:l}=await U.post("https://api-db-dbxo.onrender.com/api/book/create",{title:p.value,author:h,description:m.value,image:r},{headers:{Authorization:`Bearer ${t}`}});n.value=`Book created successfully with ID: ${l.id}`,E(),B.push(`/book/${l.id}`)}catch(l){console.error("Error creating book:",l),n.value=((s=(a=l.response)==null?void 0:a.data)==null?void 0:s.error)||"Error creating book"}},E=()=>{p.value="",m.value="",b.value=""};async function S(o){if(!o)return n.value="Please select a file first",null;const t=new FormData;t.append("file",o);try{const a=await(await fetch("https://api-db-dbxo.onrender.com/api/upload",{method:"POST",body:t})).json();return a.success?a.url:(n.value="File upload failed: "+a.message,null)}catch(r){return n.value="An error occurred: "+r.message,null}}function D(o){f.value=o.target.files[0]}return A(()=>{L(k)}),(o,t)=>{const r=x("Btn"),a=x("Back");return R(),T(z,null,[i(w(q),null,{default:g(()=>[e("title",null,`\r
            Create book | `+j(o.SITE_NAME)+`\r
        `,1)]),_:1}),e("section",O,[e("form",{onSubmit:C},[W,G,i(y),e("div",J,[e("div",null,[e("div",K,[Q,_(e("input",{type:"text",id:"title","onUpdate:modelValue":t[0]||(t[0]=s=>p.value=s),required:"",placeholder:"Enter the book title",class:"input transition duration-200"},null,512),[[v,p.value]])]),e("div",X,[Y,_(e("input",{type:"text",id:"author","onUpdate:modelValue":t[1]||(t[1]=s=>V(h)?h.value=s:null),placeholder:"Enter the book author",class:"input cursor-not-allowed"},null,512),[[v,w(h)]])]),e("div",Z,[ee,_(e("textarea",{id:"description","onUpdate:modelValue":t[2]||(t[2]=s=>m.value=s),required:"",placeholder:"Enter the book description",class:"input transit ion duration-200 resize-none h-32"},null,512),[[v,m.value]])])]),e("div",null,[e("div",te,[oe,e("input",{type:"file",id:"image",onChange:D,class:"input"},null,32)])])]),i(r,{class:"w-1/4 flex justify-center",variant:"yellow",type:"submit"},{default:g(()=>[M("Create Book")]),_:1})],32),i($,{message:n.value,type:"error",autoClose:!1,autoCloseDelay:5e3},null,8,["message"]),i(y),i(a)])],64)}}},ne=F(ae,[["__scopeId","data-v-7cfb95d6"]]);export{ne as default};
