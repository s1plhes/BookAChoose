import{y as R,r as l,e as U,g as D,A as M,j as d,c,m as q,l as C,u as o,d as i,a as e,k as n,n as m,t as u,s as P,F as G,f as g,o as a,H as J,S,q as f}from"./index-vyn2smVK.js";const K=e("meta",{name:"robots",content:"index,follow"},null,-1),O=e("meta",{property:"og:type",content:"website"},null,-1),Q=["content"],W=["content"],X=["content"],Y=["content"],Z=["content"],ee={class:"container mx-auto p-4 text-white mb-6 bg-slate-600/10 backdrop-blur-sm rounded-lg"},te={class:"space-y-3 mb-6"},oe={key:0,class:"p-2 inline-flex items-center backdrop-blur-sm bg-slate-950 rounded space-x-5"},se={key:0,class:"space-x-4"},ne={key:1},ae=e("i",{class:"fa fa-heart"},null,-1),re=e("span",null,"Font Size:",-1),le=e("i",{class:"fa-solid fa-circle-minus"},null,-1),ce=[le],ie=e("i",{class:"fa-solid fa-circle-plus"},null,-1),de=[ie],ue={key:0},pe={class:"text-3xl font-semibold mb-4"},_e=["href"],he=e("hr",{class:"border-gray-700/20 my-4"},null,-1),me=["innerHTML"],fe={class:"mt-6 py-6 flex justify-center"},ve=["href"],ke=e("div",{class:"text-2xl ml-6 text-white"},null,-1),ye={__name:"chapter_get",setup(xe){const p=R(),t=l(null),v=l(null),I=p.params.chapterId,_=l(U.get("fontSize")||18),w=l(!1),r=p.params.bookId,h=p.params.chapterId,k=l(0);l(1);const x="https://api-db-dbxo.onrender.com/",L=async()=>{try{const{data:s}=await g.get(`${x}/book/${r}/chapter/${h}`);t.value=s,v.value=z(s.body)}catch{console.error("Error fetching book")}};function z(s){return s.trim().split(/\n\s*\n/).map((b,y)=>`<div id="para-${y+1}">${b.trim()}</div>`).join("")}const V=()=>{_.value+=2},T=()=>{_.value-=2},N=async()=>{if(!w.value)try{await g.post(`${x}/chapter/${I}/view`),w.value=!0,console.log("View recorded")}catch{console.error("Error recording view")}},E=async()=>{try{const{data:s}=await g.get(`${x}/count/likes/${r}/${h}`);s&&typeof s.likes=="number"?(k.value=s.likes,console.log("Likes count:",k.value)):console.error("Unexpected response structure:",s)}catch(s){console.error("Error getting likes",s)}};let $,B=parseInt(p.params.chapterId)+parseInt(1);return D(()=>{L(),E(),$=setTimeout(()=>{N()},59e3)}),M(()=>{clearTimeout($)}),(s,F)=>{const b=d("Back"),y=d("Btn"),j=d("LikeBtn"),A=d("ViewIcon"),H=d("Comments");return a(),c(G,null,[t.value?(a(),q(o(J),{key:0},{default:C(()=>[e("title",null,u(t.value.title)+" | Book-A-Choose",1),K,O,e("meta",{property:"og:title",content:t.value.title},null,8,Q),e("meta",{property:"og:description",content:t.value.description},null,8,W),e("meta",{property:"og:image",content:t.value.image},null,8,X),e("meta",{property:"og:url",content:s.URL+"/book/"+t.value.id},null,8,Y),e("meta",{name:"author",content:t.value.author},null,8,Z)]),_:1})):i("",!0),e("div",ee,[n(b),n(S),e("div",te,[o(f)&&t.value?(a(),c("div",oe,[t.value.chapter_editor===o(f).name?(a(),c("div",se,[n(y,{variant:"primary",href:`/book/${t.value.book_id}/chapter/${o(I)}/edit`},{default:C(()=>[m(" Edit chapter ")]),_:1},8,["href"])])):i("",!0),o(f)?(a(),c("div",ne,[n(j,{userId:o(f).id,bookId:o(r),chapterId:o(h)},null,8,["userId","bookId","chapterId"])])):i("",!0),e("div",null,[ae,m(" "+u(k.value)+" likes",1)]),e("div",null,[n(A),m(" "+u(t.value.views),1)]),e("div",null,[re,e("button",{type:"button",onClick:T,class:"bg-transparent px-2 py-1 rounded"},ce),e("span",null,u(_.value)+"px",1),e("button",{type:"button",onClick:V,class:"bg-transparent px-2 py-1 rounded"},de)])])):i("",!0)]),t.value?(a(),c("div",ue,[e("h2",pe,u(t.value.title),1),m(),e("a",{class:"text-xl",href:`/book/${o(r)}/chapter/${o(B)}`,text:"Next Chapter"},null,8,_e)])):i("",!0),he,v.value?(a(),c("div",{key:1,innerHTML:v.value,style:P({fontSize:_.value+"px"}),class:"text-zinc-300 leading-relaxed first-line:uppercase first-line:tracking-widest first-letter:text-slate-900 first-letter:text-7xl first-letter:leading-none first-letter:float-left first-letter:font-bold first-letter:mr-3 dark:first-letter:text-white text-justify"},null,12,me)):i("",!0),e("div",fe,[n(S),e("a",{class:"text-xl",href:`/book/${o(r)}/chapter/${o(B)}`,text:"Next Chapter"},null,8,ve),ke]),n(H,{bookId:o(r),chapterId:o(h)},null,8,["bookId","chapterId"])])],64)}}};export{ye as default};
