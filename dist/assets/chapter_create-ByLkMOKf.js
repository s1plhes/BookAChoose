import{y as D,z as E,r as i,g as S,j as f,c as d,k as p,u as x,a as t,t as u,w as b,v as g,l as k,b as V,d as z,f as y,q as C,o as h,S as M,n as N,H as A,e as H}from"./index-vyn2smVK.js";import"./trix-C3MFUsML.js";import{c as R}from"./checkAuth-4erMPWyQ.js";const U={class:"p-6 max-w-3xl mx-auto bg-slate-900/50 backdrop-blur-sm"},q=t("a",{class:"px-4 py-1 bg-zinc-100 text-sm text-zinc-800 font-semibold rounded hover:text-black hover:bg-zinc-300 hover:border-transparent focus:outline-none focus:ring-2 focus:ring-purple-600 focus:ring-offset-2",href:"/books"},"Back",-1),L={key:0},j={class:"text-2xl font-bold text-slate-100 mb-6"},P={class:"form-group"},Y=t("label",{for:"chapter-title",class:"block text-xl font-medium text-gray-100"},"Chapter Title",-1),F={class:"form-group"},G=t("label",{for:"chapter-content",class:"block text-xl font-medium text-gray-100"},"Chapter Content",-1),J={class:"mt-1 p-1 bg-slate-50 text-slate-950"},K={key:0,class:"mt-4 text-sm text-green-600"},O={key:1},Q=t("p",{class:"text-center text-red-600"},"You must be logged in to create a chapter.",-1),W=[Q],ot={__name:"chapter_create",setup(X){const $=D(),w=E(),c=i(""),r=i(""),n=i(""),m=$.params.bookId,_=i({}),v="https://api-db-dbxo.onrender.com/",B=o=>{r.value=o.target.innerHTML},T=async()=>{var o,a;try{const e=await y.get(`${v}/book/${m}`);_.value=e.data}catch(e){console.error(e),n.value=`Error: ${((a=(o=e.response)==null?void 0:o.data)==null?void 0:a.error)||e.message}`}},I=async o=>{var e,l;o.preventDefault();const a=H.get("accessToken");try{const s=await y.post(`${v}/chapter/create`,{book_id:m,title:c.value,body:r.value},{headers:{Authorization:`Bearer ${a}`}});n.value=`Chapter created successfully with ID: ${s.data.id}`,w.push(`/book/${m}/chapter/${s.data.id}`),c.value="",r.value=""}catch(s){n.value=`Error: ${((l=(e=s.response)==null?void 0:e.data)==null?void 0:l.error)||s.message}`}};return S(()=>{R(C),T()}),(o,a)=>{const e=f("trix-editor"),l=f("Btn");return h(),d("div",U,[q,p(M),x(C)?(h(),d("div",L,[t("h1",j,"Create Chapter for "+u(_.value.title),1),t("form",{onSubmit:V(I,["prevent"]),class:"space-y-6"},[t("div",P,[Y,b(t("input",{type:"text",id:"chapter-title","onUpdate:modelValue":a[0]||(a[0]=s=>c.value=s),required:"",class:"input",placeholder:"Enter the chapter title"},null,512),[[g,c.value]])]),t("div",F,[G,t("div",J,[p(e,{id:"chapter-content",onTrixChange:B,input:"chapterContentInput"}),b(t("input",{id:"chapterContentInput",type:"hidden","onUpdate:modelValue":a[1]||(a[1]=s=>r.value=s)},null,512),[[g,r.value]])])]),t("div",null,[p(l,{variant:"primary"},{default:k(()=>[N("Submit")]),_:1})])],32),n.value?(h(),d("p",K,u(n.value),1)):z("",!0)])):(h(),d("div",O,W)),p(x(A),null,{default:k(()=>[t("title",null,`\r
                Create chapter for `+u(o.title)+" | "+u(o.SITE_NAME)+`\r
            `,1)]),_:1})])}}};export{ot as default};
